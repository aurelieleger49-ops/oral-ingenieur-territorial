<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Questions-Réponses par thème</title>
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
<h1>Questions-Réponses par thème</h1>
<div id="contenu">Chargement...</div>
<script>
const urlFichier = 'https://aurelieleger49-ops.github.io/oral-ingenieur-territorial/QR.xlsx';

fetch(urlFichier)
  .then(res => {
    if (!res.ok) throw new Error('Erreur de chargement du fichier');
    return res.arrayBuffer();
  })
  .then(data => {
    const workbook = XLSX.read(new Uint8Array(data), { type: 'array' });
    const container = document.getElementById('contenu');
    container.innerHTML = '';

    workbook.SheetNames.forEach(sheetName => {
      const worksheet = workbook.Sheets[sheetName];
      const jsonData = XLSX.utils.sheet_to_json(worksheet, { defval: '' });

      // Création de la section thème
      const section = document.createElement('section');

      const titre = document.createElement('h2');
      titre.textContent = sheetName;
      section.appendChild(titre);

      const ul = document.createElement('ul');

      jsonData.forEach(row => {
        const bloc = document.createElement('div');
        bloc.className = 'bloc';

        const questionDiv = document.createElement('div');
        questionDiv.className = 'question';
        questionDiv.textContent = row['Questions'] || '';

        const reponseDiv = document.createElement('div');
        reponseDiv.className = 'reponse';
        reponseDiv.textContent = row['Réponses'] || '';

        bloc.appendChild(questionDiv);
        bloc.appendChild(reponseDiv);

        ul.appendChild(bloc);
      });

      section.appendChild(ul);
      container.appendChild(section);
    });
  })
  .catch(error => {
    document.getElementById('contenu').textContent = 'Erreur : ' + error.message;
  });
</script>
<p><a href="index.html">Retour à l’index</a></p>
</body>
</html>
